---
title: React å¦‚ä½•åŒºåˆ†ç±»ç»„ä»¶å’Œå‡½æ•°å¼ç»„ä»¶?
date: "2020-01-15"
permalink: how-react-tell-a-class-from-a-function
---

åŸæ–‡: [How Does React Tell a Class from a Function?](https://overreacted.io/how-does-react-tell-a-class-from-a-function/)


ä¸‹é¢è¿™ä¸ª `Greeting` æ˜¯ä¸€ä¸ªå‡½æ•°å¼ React ç»„ä»¶:

```jsx
function Greeting() {
  return <p>Hello</p>;
}
```

React åŒæ ·æ”¯æŒä»¥ç±»çš„å½¢å¼å®šä¹‰ä¸€ä¸ªç»„ä»¶:

```jsx
class Greeting extends React.Component {
  render() {
    return <p>Hello</p>;
  }
}
```

(å‡½æ•°å¼ç»„ä»¶å¯ä»¥é€šè¿‡ [hooks](https://reactjs.org/docs/hooks-intro.html) ä¿å­˜çŠ¶æ€)

ä¸è¿‡å½“æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™, æˆ‘ä»¬å¹¶ä¸åœ¨æ„å®ƒæ˜¯å¦‚ä½•å®šä¹‰çš„:

```jsx
// Class or function â€” whatever.
<Greeting />
```

ä¸è¿‡ React æœ¬èº«å¯¹ç»„ä»¶æ˜¯å‡½æ•°å¼è¿˜æ˜¯ç±»å¼, ååˆ†åœ¨æ„.

å¦‚æœ `Greeting` æ˜¯å‡½æ•°å¼ç»„ä»¶, React çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯è°ƒç”¨å®ƒ:

```jsx
// Your code
function Greeting() {
  return <p>Hello</p>;
}

// Inside React
const result = Greeting(props); // <p>Hello</p>
```

å¦‚æœ `Greeting` æ˜¯ç±»å¼ç»„ä»¶, React çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯ä½¿ç”¨ `new` æ“ä½œç¬¦æ¥å®ä¾‹åŒ–è¿™ä¸ªç»„ä»¶, å¹¶è°ƒç”¨æ‰€åˆ›å»ºå®ä¾‹çš„ `render` æ–¹æ³•.

```jsx
// Your code
class Greeting extends React.Component {
  render() {
    return <p>Hello</p>;
  }
}

// Inside React
const instance = new Greeting(props); // Greeting {}
const result = instance.render(); // <p>Hello</p>
```

ä»¥ä¸Šä¸¤ç§æƒ…å†µä¸‹, React çš„ç›®æ ‡éƒ½æ˜¯è·å–éœ€è¦è¢«æ¸²æŸ“çš„ DOM èŠ‚ç‚¹(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ `<p>Hello</p>` ). å…·ä½“çš„è·å–æ­¥éª¤, è¿˜æ˜¯æ ¹æ® `Greeting` å¦‚ä½•è¢«å®šä¹‰æ¥å†³å®š.

**é‚£ä¹ˆ React æ˜¯å¦‚ä½•çŸ¥é“ç»„ä»¶æ˜¯ç±»è¿˜æ˜¯å‡½æ•°çš„å‘¢?**

å°±åƒæˆ‘åœ¨[è¿™ç¯‡æ–‡ç« ](https://overreacted.io/why-do-we-write-super-props/)ä¸­è¯´çš„, å³ä½¿ä¸çŸ¥é“è¿™ç‚¹, **ä½ ä¹Ÿèƒ½å¤Ÿé«˜æ•ˆåœ°ç”¨ React æ„å»ºå‡º web åº”ç”¨.** æˆ‘ä¹Ÿå¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±äº†è§£è¿™ä¸ªçŸ¥è¯†çš„, å› æ­¤è¯·ä¸è¦å°†è¿™ä¸ªçŸ¥è¯†ç‚¹ä½œä¸ºé¢è¯•é¢˜è¯¢é—®æ±‚èŒè€…. å®é™…ä¸Š, è¿™ç¯‡æ–‡ç« æ‰€æ¶‰åŠçš„çŸ¥è¯†æ›´åå‘äº JavaScript è€Œä¸æ˜¯ React.

è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡è¯»è€…æ˜¯å¯¹ React çš„åº•å±‚åŸç†æœ‰å¥½å¥‡å¿ƒçš„å¼€å‘è€…, å¦‚æœä½ æ˜¯çš„è¯, é‚£ä¹ˆå°±è®©æˆ‘ä»¬ä¸€èµ·æ¢ç´¢å§.

**æˆ‘ä»¬çš„æ¢ç´¢æ—…ç¨‹ä¼šå¾ˆé•¿. è¯·ç³»å¥½å®‰å…¨å¸¦. æœ¬æ–‡æ¶‰åŠåˆ°çš„ React çŸ¥è¯†ç‚¹å…¶å®å¹¶ä¸å¤š, æ›´å¤šçš„æ˜¯å…³äº JavaScript çš„çŸ¥è¯†ç‚¹, æ¯”å¦‚è¯´: `new` , `this` , `class` , ç®­å¤´å‡½æ•°, `prototype` , `__proto__`, `instanceof` ç­‰. å¹¸è¿çš„æ˜¯, å½“ä½ åœ¨ä½¿ç”¨ React çš„æ—¶å€™, å¹¶ä¸éœ€è¦ç‰¹åˆ«è€ƒè™‘è¿™äº›. ä¸è¿‡ç«™åœ¨ React çš„å¼€å‘è€…è§’åº¦, æƒ…å†µå°±ä¸ä¸€æ ·äº†......**

(å¦‚æœä½ ä¸å¸Œæœ›äº†è§£å®ç°ç»†èŠ‚, åªæƒ³è¦çŸ¥é“ç­”æ¡ˆ, è¯·ç›´æ¥æŸ¥çœ‹æ–‡æœ«çš„å†…å®¹.)

---

é¦–å…ˆæˆ‘ä»¬éœ€è¦ç†è§£, ä¸ºä»€ä¹ˆåŒºåˆ«å¯¹å¾…å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æ˜¯é‡è¦çš„. å½“æˆ‘ä»¬è°ƒç”¨ç±»ç»„ä»¶æ—¶å€™, éœ€è¦ä¾èµ– `new` æ“ä½œç¬¦:

```jsx
// å¦‚æœ Greeting æ˜¯å‡½æ•°å¼ç»„ä»¶, åœ¨reactå†…éƒ¨ä¼šè¢«è¿™æ ·è°ƒç”¨
const result = Greeting(props); // <p>Hello</p>
// å¦‚æœ Greeting æ˜¯ class ç»„ä»¶, åœ¨reactå†…éƒ¨ä¼šè¢«è¿™æ ·è°ƒç”¨
const instance = new Greeting(props); // Greeting {}
const result = instance.render(); // <p>Hello</p>
```

ç°åœ¨æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹, `new` æ“ä½œç¬¦åœ¨ JavaScript ä¸­å…·ä½“åšäº†äº›ä»€ä¹ˆ.

---

è¿‡å» JavaScript ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µ. ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªä¸ç±»æœ‰ç±»ä¼¼åŠŸèƒ½çš„å‡½æ•°. å…·ä½“è§ä¸‹é¢çš„ä¾‹å­, é’ˆå¯¹è¿™ç§ç‰¹æ®Šçš„å‡½æ•°, æˆ‘ä»¬ä½¿ç”¨ `new`å…³é”®å­—è¿›è¡Œè°ƒç”¨.

```jsx
// åªæ˜¯ä¸€ä¸ªå‡½æ•°
function Person(name) {
  this.name = name;
}

var fred = new Person('Fred'); // âœ… Person {name: 'Fred'}
var george = Person('George'); // ğŸ”´ ä¸ä¼šèµ·ä½œç”¨, 
// å¦‚æœå°†ä»£ç åœ¨æ§åˆ¶å°æ‰§è¡Œ, ä¼šå‘ç° this æŒ‡å‘å…¨å±€ window.name æ˜¯ George
```

å¦‚æœæˆ‘ä»¬è°ƒç”¨ `Person('Fred')` æ—¶æ²¡æœ‰åŠ ä¸Š `new` å…³é”®å­—, å‡½æ•°ä¸­çš„ `this` ä¼šæŒ‡å‘å…¨å±€, é‚£ä¹ˆè¿™ä¸ª `this` å°±ä¸€ç‚¹æ„ä¹‰ä¹Ÿæ²¡æœ‰äº†. æˆ‘ä»¬çš„ä»£ç ä¼šå´©æºƒ, åŒæ—¶è¿˜åšäº†ä»¶è ¢äº‹: åˆ›å»ºäº†ä¸€ä¸ªæ— ç”¨çš„å…¨å±€å˜é‡.

**é‚£ä¹ˆä½¿ç”¨ `new` è°ƒç”¨å‡½æ•°æ—¶å…·ä½“å‘ç”Ÿäº†äº›ä»€ä¹ˆå‘¢?**

åœ¨è°ƒç”¨å‡½æ•°æ—¶æ·»åŠ `new`, ç›¸å½“äºå‘Šè¯‰ JavaScript, `Person`è™½ç„¶åªæ˜¯ä¸ªå‡½æ•°, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹åšç±»æ„é€ å™¨. **æ­¤æ—¶ JavaScript å°±ä¼šåˆ›å»ºä¸€ä¸ª`{}`å¯¹è±¡, ç„¶å`Person`ä¸­çš„`this`å€¼æŒ‡å‘è¯¥å¯¹è±¡, åŒæ—¶å°† `name` è®¾ç½®ä¸ºè¯¥å¯¹è±¡çš„å±æ€§, å¹¶ä¸” `return` å‡ºè¯¥å¯¹è±¡.**

```jsx
var fred = new Person('Fred'); // Same object as `this` inside `Person`
```

é€šè¿‡ä»¥ä¸Šçš„ `new` è°ƒç”¨, å¯¹è±¡ `fred` è¿˜å¯ä»¥è¯»å–æ„é€ å™¨å‡½æ•° `Person.prototype` ä¸Šçš„å±æ€§.

```jsx
function Person(name) {
  this.name = name;
}
Person.prototype.sayHi = function() {
  console.log('Hi, I am ' + this.name);
}

var fred = new Person('Fred');
fred.sayHi();
```

åœ¨ JavaScript ä¸åŸç”Ÿæ”¯æŒ`class`ä¹‹å‰, å¼€å‘è€…å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¨¡æ‹Ÿç±»çš„.

---

`new` å…³é”®å­—å­˜åœ¨å·²ä¹…, è€Œ `class` çš„æ”¯æŒå´æ˜¯è¿‘æ®µæ—¶é—´çš„äº‹. ç°åœ¨æˆ‘ä»¬ä½¿ç”¨`class`æ”¹å†™å…ˆå‰çš„ä»£ç .

```jsx
class Person {
  constructor(name) {
    this.name = name;
  }
  sayHi() {
    alert('Hi, I am ' + this.name);
  }
}

let fred = new Person('Fred');
fred.sayHi();
```

åœ¨è®¾è®¡ç¼–ç¨‹è¯­è¨€å’Œ API æ—¶, ç”¨æˆ·çš„ç—›ç‚¹è‡³å…³é‡è¦.

å¼€å‘è€…åœ¨ç¼–å†™å‡½æ•°æ—¶, JavaScript æ— æ³•çŒœæµ‹åˆ°å‡½æ•°æ˜¯éœ€è¦è¢«ç›´æ¥è°ƒç”¨è¿˜æ˜¯åœ¨ä¹‹å‰åŠ å…³é”®è¯ `new` è°ƒç”¨.  å› æ­¤å¼€å‘è€…åœ¨è°ƒç”¨ç±»ä¼¼ `Person` è¿™æ ·çš„æ„é€ å‡½æ•°æ—¶, åŠ¡å¿…è®°å¾—åœ¨å‰é¢æ·»åŠ  `new` å…³é”®å­—, å¦åˆ™å°±ä¼šç»™ç¨‹åºå¼•å…¥ä¸€äº›ä»¤äººç–‘æƒ‘çš„é—®é¢˜.

**æœ‰äº† Class è¯­æ³•ä¹‹å, æˆ‘ä»¬çš„è¯­å¢ƒä¸­å°±æœ‰äº†ç±»çš„æ¦‚å¿µ, å¯¹äºè¿™ç±»ç‰¹æ®Šçš„å‡½æ•°, æˆ‘ä»¬å°±èƒ½è¯´, å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå‡½æ•°, è€Œæ˜¯ä¸€ä¸ªç±», åŒæ—¶æœ‰è‡ªå·±çš„æ„é€ å‡½æ•°.** å¦‚æœä½ åœ¨è°ƒç”¨å®ƒçš„æ—¶å€™å¿˜äº†åŠ ä¸Š `new` å…³é”®å­—, JavaScript å°±ä¼šæŠ›å‡ºé”™è¯¯.

```jsx
let fred = new Person('Fred');
// âœ…  If Person is a function: works fine
// âœ…  If Person is a class: works fine too

let george = Person('George'); // We forgot `new`
// ğŸ˜³ If Person is a constructor-like function: confusing behavior
// ğŸ”´ If Person is a class: fails immediately
```

è¿™æ ·ä¸€æ¥, æˆ‘ä»¬å°±é¿å…å†™å‡ºé€ æˆè®¸å¤šéšè—bugçš„ä»£ç , æ¯”å¦‚ `this.name` è¢«å½“ä½œæ˜¯ `window.name` è€Œä¸æ˜¯æˆ‘ä»¬æ‰€é¢„æœŸçš„ `george.name` .

ä¸è¿‡å¦‚æœ React ä¹Ÿå¿…é¡»éµå¾ªè¿™ä¸ªåŸåˆ™çš„è¯, é‚£ä¹ˆåœ¨è°ƒç”¨ä»»ä½•ç±»ç»„ä»¶çš„æ—¶å€™, å°±å¿…é¡»åœ¨ä¹‹å‰åŠ ä¸Š `new` å…³é”®å­—, å¦åˆ™çš„è¯ JavaScript å°±ä¼šæŠ›å‡ºå¼‚å¸¸.

```jsx
class Counter extends React.Component {
	render() {
		return <p>Hello</p>;
	}
}

// ğŸ”´ React æ— æ³•è¿™æ ·åš
const instance = Counter(props);
```

---

é‚£ä¹ˆ React æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢? å¤§å¤šæ•°å¼€å‘è€…åœ¨ä½¿ç”¨Reactæ—¶ä¼šåŒæ—¶ä½¿ç”¨`Babel` æ¥ç¼–è¯‘æœ€æ–°è¯­æ³•çš„ä»£ç ä»¥å…¼å®¹æ—§ç‰ˆæœ¬çš„æµè§ˆå™¨. å› æ­¤æˆ‘ä»¬æŠŠè§£å†³æ–¹æ¡ˆçš„å¤´ç»ªæ”¾åœ¨äº†ç¼–è¯‘å™¨ä¸Š.

åœ¨å‰å‡ ä¸ªç‰ˆæœ¬çš„ `Babel` ä¸­, ç±»å¯ä»¥ä¸éœ€è¦å£°æ˜ `new` å…³é”®å­—ç›´æ¥è°ƒç”¨, ä½†æ˜¯è¿™ä¸ªé—®é¢˜å¾ˆå¿«è¢« `Babel` å›¢é˜Ÿä¿®å¤äº†, æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»–ä»¬çš„ä¿®å¤æ–¹å¼:

```jsx
function Person(name) {
  // A bit simplified from Babel output:
  if (!(this instanceof Person)) {
    throw new TypeError("Cannot call a class as a function");
  }
  // Our code:
  this.name = name;
}

new Person('Fred'); // âœ… Okay
Person('George');   // ğŸ”´ Cannot call a class as a function
```

å¦‚æœä½ çœ‹è¿‡é¡¹ç›®æ‰“åŒ…ä¹‹åçš„ä»£ç çš„è¯, å¯èƒ½ä¼šè§‰å¾—è¿™ä¸ªå‡½æ•°ä¼¼æ›¾ç›¸è¯†, è¿™ä¸ªå°±æ˜¯`_classCallCheck` å‡½æ•°æ‰€åšçš„äº‹æƒ…. (ä½ å¯ä»¥é€šè¿‡å¼€å¯"å®½æ¾æ£€æŸ¥æ¨¡å¼"æ¥å‡å°‘æ‰“åŒ…ä¹‹åä»£ç çš„é‡, ä½†æ˜¯è¿™å½“ç„¶ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜: å½“å¤„ç†çœŸæ­£çš„åŸç”Ÿç±»è¯­æ³•æ—¶, æƒ…å†µä¼šå˜å¾—æ›´åŠ å¤æ‚. You can reduce the bundle size by opting into the â€œloose modeâ€ with no checks but this might complicate your eventual transition to real native classes.)

---

è‡³æ­¤, æˆ‘ä»¬æ˜ç™½äº†è°ƒç”¨å‡½æ•°æ—¶åŠ  `new` ä¸ä¸åŠ  `new` çš„åŒºåˆ«:

![compare](/posts/images/compare.png)

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ, åœ¨Reactä¸­, æ­£ç¡®è°ƒç”¨ç»„ä»¶æ˜¯å¤šä¹ˆé‡è¦. **å¦‚æœç»„ä»¶è¢«å®šä¹‰ä¸ºç±»ç»„ä»¶, Reactå¿…é¡»åœ¨å‰æ·»åŠ  `new` å…³é”®å­—è¿›è¡Œè°ƒç”¨.**

é‚£ä¹ˆ React æ˜¯å¦å¯ä»¥ä¸ä¾èµ–ä»»ä½•å…¶ä»–ä¿¡æ¯åŒºåˆ†å‡ºç»„ä»¶æ˜¯å‡½æ•°å¼ç»„ä»¶è¿˜æ˜¯classç»„ä»¶å‘¢?

å¹¶ä¸ç®€å•. è™½ç„¶æˆ‘ä»¬[åœ¨ JavaScript ä¸­å¯ä»¥åŒºåˆ†å‡º class å‡½æ•°å’Œæ™®é€šå‡½æ•°](https://stackoverflow.com/questions/29093396/how-do-you-check-the-difference-between-an-ecmascript-6-class-and-function), ä½†æ˜¯è¢« `Babel` å¤„ç†è¿‡çš„ä»£ç , å°±å¾ˆéš¾åŒºåˆ†äº†. å› ä¸ºç»è¿‡å¤„ç†ä¹‹å, å¯¹äºæµè§ˆå™¨æ¥è¯´, å®ƒä»¬éƒ½æ˜¯æ™®é€šçš„å‡½æ•°. ä¸è¿‡åœ¨ React ä¸­, æˆ‘ä»¬è¿˜æ˜¯æœ‰åŠæ³•å¤„ç†çš„.

---

æˆ–è®¸ React å¯ä»¥é’ˆå¯¹æ¯ä¸€æ¬¡è°ƒç”¨éƒ½åŠ ä¸Š `new` å…³é”®å­—? é—æ†¾çš„äº‹, è¿™æ ·çš„æ–¹å¼å¹¶ä¸é è°±. 

è°ƒç”¨æ™®é€šå‡½æ•°æ—¶æ·»åŠ  `new` å…³é”®å­—ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªå¯¹è±¡å®ä¾‹. é’ˆå¯¹æ„é€ å™¨å‡½æ•°, ä½¿ç”¨ `new` è°ƒç”¨æ˜¯é¢„æœŸè¡Œä¸º, ä½†æ˜¯é’ˆå¯¹å‡½æ•°å¼ç»„ä»¶, è¿™ç§è°ƒç”¨æ–¹å¼å°±ä¼šè®©äººè§‰å¾—ç–‘æƒ‘.

```jsx
function Greeting() {
  // We wouldnâ€™t expect `this` to be any kind of instance here
  return <p>Hello</p>;
}
```

ä»¥ä¸Šè¿™ä¸ªåŸå› å¹¶æ²¡æœ‰åˆ°ä¸èƒ½æ¥å—çš„ç¨‹åº¦, ä½†æ˜¯è¿˜æœ‰å…¶ä»–ä¸¤ä¸ªé‡è¦åŸå› å†³å®šäº†ä¸å¯ä»¥å§‹ç»ˆæ·»åŠ  `new` å…³é”®è¯è¿›è¡Œå‡½æ•°è°ƒç”¨.

---

ç¬¬ä¸€ä¸ªåŸå› æ˜¯ä½¿ç”¨ `new` è°ƒç”¨ç®­å¤´å‡½æ•°(æœªè¢« Babel ç¼–è¯‘è¿‡) ä¼šæŠ›å‡ºå¼‚å¸¸:

```jsx
const Greeting = () => <p>Hello</p>;
new Greeting(); // ğŸ”´ Greeting is not a constructor
```

ç”±äºä¸ç¬¦åˆç®­å¤´å‡½æ•°çš„è®¾è®¡è¯­æ³•, JavaScript æœ‰æ„é™åˆ¶äº†è¿™ç§è¡Œä¸º. ç®­å¤´å‡½æ•°æœ€ä¸»è¦çš„ç‰¹ç‚¹ä¹‹ä¸€æ˜¯æ²¡æœ‰è‡ªå·±çš„ `this` , å¦‚æœåœ¨ç®­å¤´å‡½æ•°å†…éƒ¨ä½¿ç”¨ `this` çš„è¯, `this` çš„å€¼ä¼šç”±ç¦»å®ƒæœ€è¿‘çš„æ™®é€šå‡½æ•°å†³å®š.

```jsx
class Friends extends React.Component {
  render() {
    const friends = this.props.friends;
    return friends.map(friend =>
      <Friend
        // `this` is resolved from the `render` method
        size={this.props.size}
        name={friend.name}
        key={friend.id}
      />
    );
  }
}
```

ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`. å› æ­¤æˆ‘ä»¬æ²¡æœ‰åŠæ³•å°†ç®­å¤´å‡½æ•°æ”¹é€ ä¸ºæ„é€ å™¨å‡½æ•°.

```jsx
const Person = (name) => {
  // ğŸ”´ This wouldnâ€™t make sense!
  this.name = name;
}
```

**JavaScript** ç¦æ­¢äº†ä½¿ç”¨ `new` è°ƒç”¨ç®­å¤´å‡½æ•°çš„è¡Œä¸º. ä¹Ÿæ˜¯ç”±äºåŒæ ·çš„åŸå› , æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ `new` å…³é”®è¯å®ä¾‹åŒ–ä¸€ä¸ªç±». 

å› æ­¤, åœ¨Reactä¸­ç”¨ `new` è°ƒç”¨å‡½æ•°æ˜¯ä¸åˆç†çš„. é‚£ä¹ˆé’ˆå¯¹è¿™ç§æƒ…å†µ, æˆ‘ä»¬æ˜¯å¦å¯ä»¥æ£€æµ‹å‡ºå‡½æ•°æ˜¯å¦ä¸ºç®­å¤´å‡½æ•°(å¦‚æœæ²¡æœ‰ `prototype` , åˆ™éç®­å¤´å‡½æ•°), ç„¶åé’ˆå¯¹å®ƒåšäº›ç‰¹æ®Šå¤„ç† (ä¸è¦ç”¨ `new` å»è°ƒç”¨å®ƒ).

```jsx
(() => {}).prototype; // undefined
(function() {}).prototype // {constructor: f}
```

ä½†æ˜¯å‡½æ•°ç»è¿‡Babelç¼–è¯‘ä¹‹å, å°±[ä¸èƒ½å¤Ÿç”¨ä»¥ä¸Šçš„æ–¹å¼åˆ¤æ–­](https://github.com/facebook/react/issues/4599#issuecomment-136562930)äº†. ç¼–è¯‘ä¹‹åçš„ç»“æœ:

```jsx
"use strict";

(function () {}).prototype;
(function () {}).prototype; 
```

ä¸è¿‡è¿™ä¸ªé—®é¢˜æ¯”è¾ƒå¥½è§£å†³, å½±å“æ¯”è¾ƒä¸¥é‡çš„æ˜¯å¦ä¸€ä¸ªåŸå› :

---

å½“å‡½æ•°çš„è¿”å›å€¼æ˜¯å­—ç¬¦ä¸²æˆ–å…¶ä»–åŸå§‹ç±»å‹æ—¶, ä½¿ç”¨ `new` å¯¹å…¶è¿›è¡Œè°ƒç”¨ä¸ä¼šå¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœ.

```jsx
function Greeting() {
  return 'Hello';
}

Greeting(); // âœ… 'Hello'
new Greeting(); // ğŸ˜³ Greeting {}
```

è¿™ä¸ªè¡Œä¸ºå’Œ `new` [æ“ä½œç¬¦](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new)æœ¬èº«çš„è®¾è®¡æœ‰å…³. åœ¨å‰æ–‡ä¸­æˆ‘ä»¬çŸ¥é“, `new` ä¼šå‘Šè¯‰ JavaScript å¼•æ“åˆ›å»ºä¸€ä¸ªå¯¹è±¡,  `this` æŒ‡å‘æ‰€åˆ›å»ºçš„å¯¹è±¡å®ä¾‹, ç„¶å `return` å‡ºè¯¥å®ä¾‹.

JavaScript  åŒæ ·å…è®¸å‡½æ•°è¢« `new` è°ƒç”¨æ—¶, é€šè¿‡æ§åˆ¶ `return` çš„å€¼æ¥è¦†ç›–é»˜è®¤è¿”å›çš„å¯¹è±¡.  å½“åœ¨å¯¹è±¡æ± æ¨¡å¼ä¸‹, æƒ³è¦å¤ç”¨å‡½æ•°å®ä¾‹æ—¶, è¿™ç§æ¨¡å¼å°±å¯ä»¥å‘æŒ¥ä½œç”¨äº†. 

```jsx
// Created lazily
var zeroVector = null;

function Vector(x, y) {
  if (x === 0 && y === 0) {
    if (zeroVector !== null) {
      // Reuse the same instance
      return zeroVector;
    }
    zeroVector = this;
  }
  this.x = x;
  this.y = y;
}

var a = new Vector(1, 1);
var b = new Vector(0, 0);
var c = new Vector(0, 0); // ğŸ˜² b === c
```

ä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯, å½“æ‰‹åŠ¨ `return` å‡ºçš„ä¸æ˜¯å¯¹è±¡, è€Œæ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ç±»å‹, è¿™äº›å€¼å°±æ— æ³•è¦†ç›–é»˜è®¤çš„å¯¹è±¡.

```jsx
function Answer() {
  return 42;
}

Answer(); // âœ… 42
new Answer(); // ğŸ˜³ Answer {}
```

å› æ­¤, å¦‚æœå§‹ç»ˆç”¨ `new` è°ƒç”¨å‡½æ•°, `React` å°±æ°¸è¿œæ— æ³•æ”¯æŒè¿”å›å€¼ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦ä¸²çš„ç»„ä»¶äº†.

ç”±äºè¿™ä¸ªåŸå› , æˆ‘ä»¬å¿…é¡»åšå‡ºä¸€äº›å¦¥å.

---

è‡³æ­¤æˆ‘ä»¬å­¦åˆ°äº†: React é’ˆå¯¹ç±»ç»„ä»¶è°ƒç”¨æ—¶(åŒ…æ‹¬ç»è¿‡ Babel å¤„ç†çš„ç»“æœ), éœ€è¦æ·»åŠ  `new` å…³é”®å­—, ä½†æ˜¯æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°è°ƒç”¨å´ä¸éœ€è¦. å¯æ˜¯åˆ°ç›®å‰ä¸ºæ­¢å¹¶æ²¡æœ‰å¯é çš„æ–¹æ³•å¯¹è¿™ä¸¤ç§æ–¹å¼è¿›è¡ŒåŒºåˆ†.

**ä¸è¿‡æˆ‘ä»¬æ˜¯å¦å¯ä»¥è½¬æ¢çœ‹é—®é¢˜çš„è§’åº¦, é’ˆå¯¹é€šç”¨çš„é—®é¢˜æˆ‘ä»¬æ²¡æœ‰åŠæ³•è§£å†³, é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ›´å…·ä½“çš„é—®é¢˜å»è§£å†³. If we canâ€™t solve a general problem, can we solve a more specific one?** 

å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª React ç±»ç»„ä»¶æ—¶, è¯¥ç»„ä»¶ä¸€å®šä¼šç»§æ‰¿ `React.Component` ä»¥ä¾¿ä½¿ç”¨ React çš„å†…éƒ¨æ–¹æ³• `this.setState()` .  **è¿™æ ·çš„è¯, æˆ‘ä»¬æ˜¯å¦å°±ä¸éœ€è¦æ£€æµ‹æ‰€æœ‰çš„ç±», åªéœ€è¦æ£€æµ‹ç»§æ‰¿ `React.Component` çš„ç»„ä»¶å³å¯?**

å‰§é€: è¿™å°±æ˜¯Reactçš„å¤„ç†æ–¹å¼.

---

ç°åœ¨æˆ‘ä»¬è¦æ£€æµ‹ `Greeting` æ˜¯å¦æ˜¯ä¸€ä¸ªReact ç±»ç»„ä»¶, æœ€ç¬¦åˆç›´è§‰çš„æ£€æµ‹æ–¹å¼æ˜¯ `Greeting.prototype instanceof React.Component` :

```jsx
class A {}
class B extends A {}

console.log(B.prototype instanceof A); // true
```

ä¸ºäº†ç†è§£ä»¥ä¸Šä»£ç çš„å«ä¹‰, æˆ‘ä»¬é¦–å…ˆè¦ç†è§£ JavaScript åŸå‹.  

å¤§å®¶å¯¹"åŸå‹é“¾"è¿™ä¸ªæ¦‚å¿µåº”è¯¥å·²ç»å¾ˆç†Ÿæ‚‰äº†. åœ¨JavaScriptä¸­, æ‰€æœ‰å¯¹è±¡å¯èƒ½å­˜åœ¨ä¸€ä¸ª"åŸå‹". å½“æˆ‘ä»¬æ‰§è¡Œè¿™æ®µä»£ç  `fred.sayHi()` æ—¶, `fred` è¿™ä¸ªå¯¹è±¡æœ¬èº«å¯èƒ½å¹¶ä¸å­˜åœ¨ `sayHi` å±æ€§. æˆ‘ä»¬ä¼šä» `fred` çš„åŸå‹ä¸Šå¯»æ‰¾è¿™ä¸ªå±æ€§. å¦‚æœæ²¡æœ‰æ‰¾åˆ°, åˆ™ä¼šå†æ·±å…¥åŸå‹é“¾å¯»æ‰¾ â€” `fred` çš„åŸå‹çš„åŸå‹. ç›´åˆ°æ‰¾åˆ°è¿™ä¸ªå±æ€§ä¸ºæ­¢.

ä½†æ¯”è¾ƒä»¤äººç–‘æƒ‘çš„ä¸€ç‚¹æ˜¯, ç±»æˆ–è€…å‡½æ•°çš„ `prototype` å±æ€§ä¸å®ƒçš„åŸå‹å¹¶ä¸å¯¹ç­‰.

```jsx
function Person() {}

console.log(Person.prototype); // ğŸ¤ª Not Person's prototype
console.log(Person.__proto__); // ğŸ˜³ Person's prototype
```

åŸå‹é“¾çš„ç»“æ„æ˜¯ `__proto__.__proto__.__proto__` è€Œä¸æ˜¯ `prototype.prototype.prototype` .

é‚£è¿™ä¸ª `prototype` å±æ€§æ˜¯ä»€ä¹ˆå‘¢?  å½“æˆ‘ä»¬ç”¨ `new` å®ä¾‹åŒ–ä¸€ä¸ªç±»æˆ–è€…å‡½æ•°æ—¶, å®ä¾‹çš„ `__proto__` å±æ€§å°±æ˜¯å°±æ˜¯ç±»æˆ–å‡½æ•°çš„ `prototype` å±æ€§.

```jsx
function Person(name) {
  this.name = name;
}
Person.prototype.sayHi = function() {
  alert('Hi, I am ' + this.name);
}

var fred = new Person('Fred'); // Sets `fred.__proto__` to `Person.prototype`
```

JavaScriptä½¿ç”¨**`__proto__`** é“¾æŸ¥è¯¢å±æ€§:

```jsx
fred.sayHi();
// 1. Does fred have a sayHi property? No.
// 2. Does fred.__proto__ have a sayHi property? Yes. Call it!

fred.toString();
// 1. Does fred have a toString property? No.
// 2. Does fred.__proto__ have a toString property? No.
// 3. Does fred.__proto__.__proto__ have a toString property? Yes. Call it!
```

ä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­, ä½ ä¸åº”è¯¥ç›´æ¥ä½¿ç”¨ `__proto__` , é™¤éè°ƒè¯•æ—¶éœ€è¦æŸ¥è¯¢ä¸åŸå‹é“¾ç›¸å…³çš„ä¿¡æ¯. å¦‚æœä½ æƒ³ä½¿æŸäº›å±æ€§å¯ä»¥åˆ©ç”¨ `fred.__proto__` è®¿é—®, å°±åº”è¯¥å°†è¯¥ä¿¡æ¯æ”¾åœ¨ `Person.prototype` . è¿™ä¹Ÿæ˜¯ `prototype` è®¾è®¡çš„åˆè¡·.

`__proto__` å±æ€§å…¶å®å¹¶ä¸åº”è¯¥æš´éœ²ç»™å¤–éƒ¨, å› ä¸ºå®ƒæœ¬è´¨ä¸Šåªç»™ JavaScript å†…éƒ¨ä½¿ç”¨. ä½†æ˜¯æŸäº›æµè§ˆå™¨ä¾ç„¶æ”¯æŒäº†è¯¥å±æ€§ç”šè‡³å°†å…¶æ ‡å‡†åŒ–(ä¸è¿‡å®ƒä¼šé€æ¸è¢« `Object.getPrototypeOf()` æ‰€æ›¿ä»£çš„.)

**ç°åœ¨æˆ‘ä¾ç„¶ç–‘æƒ‘çš„æ˜¯: å¯¹è±¡çš„ `prototype` å±æ€§å¯¹åº”çš„å€¼ç«Ÿç„¶ä¸æ˜¯å¯¹è±¡çš„åŸå‹**(ä¸¾ä¸ªä¾‹å­: `fred.prototype` çš„å€¼ä¸º `undefined` , å› ä¸º `fred` ä¸æ˜¯ä¸€ä¸ªå‡½æ•°). ä¸ªäººè®¤ä¸º, è¿™æ˜¯å¼€å‘è€…éš¾ä»¥ç†è§£ JavaScript åŸå‹æ¦‚å¿µçš„ä¸»è¦åŸå› .

---

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†, å½“æˆ‘ä»¬è¾“å…¥ `obj.foo` æ—¶, JavaScript å®é™…ä¸Šä¼šåœ¨ `obj` `obj.__proto__`, `obj.__proto__.__proto__` ...ä¸Šå¯»æ‰¾ `foo` å±æ€§.

åœ¨ JavaScript ç±»ä¸­, å¹¶æ²¡æœ‰ç›´æ¥æš´éœ²è¿™ä¸ªæœºåˆ¶, ä¸è¿‡ `extends` çš„å®ç°åŸºäºè¿™ç§åŸå‹é“¾æœºåˆ¶. è¿™ä¹Ÿæ˜¯æˆ‘ä»¬çš„ React ç±»å®ä¾‹è¯»å– `setState` æ–¹æ³•æ‰€åˆ©ç”¨çš„æœºåˆ¶:

```jsx
class Greeting extends React.Component {
  render() {
    return <p>Hello</p>;
  }
}

let c = new Greeting();
console.log(c.__proto__); // Greeting.prototype
console.log(c.__proto__.__proto__); // React.Component.prototype
console.log(c.__proto__.__proto__.__proto__); // Object.prototype

c.render();      // Found on c.__proto__ (Greeting.prototype)
c.setState();    // Found on c.__proto__.__proto__ (React.Component.prototype)
c.toString();    // Found on c.__proto__.__proto__.__proto__ (Object.prototype)
```

ä¹Ÿå°±æ˜¯è¯´, **å½“æˆ‘ä»¬ä½¿ç”¨ç±»çš„æ—¶å€™, ç±»å®ä¾‹çš„ `__proto__` é“¾åæ˜ äº†è¿™ç§åŸå‹é“¾å…³ç³»:**

```jsx
// `extends` chain
Greeting
  â†’ React.Component
    â†’ Object (implicitly)

// `__proto__` chain
new Greeting()
  â†’ Greeting.prototype
    â†’ React.Component.prototype
      â†’ Object.prototype
```

é‚£ä¹ˆæ—¢ç„¶äº†è§£äº† `__proto__` é“¾çš„æ¦‚å¿µ, æˆ‘ä»¬å°±èƒ½é€šè¿‡è¿™ç§æ–¹å¼æ£€æŸ¥ `Greeting` æ˜¯å¦ç»§æ‰¿è‡ª `React.Component` , ä» `Greeting.prototype` å¼€å§‹é€šè¿‡ `__proto__` ä¸æ–­å±‚å±‚æ·±å…¥.

```jsx
// `__proto__` chain
new Greeting()
  â†’ Greeting.prototype // ğŸ•µï¸ We start here
    â†’ React.Component.prototype // âœ… Found it!
      â†’ Object.prototype
```

è¿˜æœ‰ä¸€ä¸ªæ›´åŠ æ–¹ä¾¿çš„æ–¹å¼, `x instanceof Y` ä¹Ÿå¯ä»¥å®ç°ä¸ä»¥ä¸Šä»£ç å‡ ä¹å·®ä¸å¤šçš„åŠŸèƒ½. è·Ÿç€ `x.__proro__` çš„åŸå‹é“¾å¯»æ‰¾ `Y.prototype` .

æ­£å¸¸æƒ…å†µä¸‹, æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹å¼æ¥åˆ¤æ–­ç±»çš„å®ä¾‹:

```jsx
let greeting = new Greeting();

console.log(greeting instanceof Greeting); // true
// greeting (ğŸ•µï¸â€ We start here)
//   .__proto__ â†’ Greeting.prototype (âœ… Found it!)
//     .__proto__ â†’ React.Component.prototype 
//       .__proto__ â†’ Object.prototype

console.log(greeting instanceof React.Component); // true
// greeting (ğŸ•µï¸â€ We start here)
//   .__proto__ â†’ Greeting.prototype
//     .__proto__ â†’ React.Component.prototype (âœ… Found it!)
//       .__proto__ â†’ Object.prototype

console.log(greeting instanceof Object); // true
// greeting (ğŸ•µï¸â€ We start here)
//   .__proto__ â†’ Greeting.prototype
//     .__proto__ â†’ React.Component.prototype
//       .__proto__ â†’ Object.prototype (âœ… Found it!)

console.log(greeting instanceof Banana); // false
// greeting (ğŸ•µï¸â€ We start here)
//   .__proto__ â†’ Greeting.prototype
//     .__proto__ â†’ React.Component.prototype 
//       .__proto__ â†’ Object.prototype (ğŸ™…â€ Did not find it!)
```

åŒæ—¶ä¹Ÿèƒ½ç”¨æ¥åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦ç»§æ‰¿è‡ªå¦ä¸€ä¸ªç±»:

```jsx
console.log(Greeting.prototype instanceof React.Component);
// greeting
//   .__proto__ â†’ Greeting.prototype (ğŸ•µï¸â€ We start here)
//     .__proto__ â†’ React.Component.prototype (âœ… Found it!)
//       .__proto__ â†’ Object.prototype
```

ä»¥ä¸Šè¿™ç§æ–¹å¼å¯ä»¥ç”¨ä»¥åŒºåˆ†React ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶.

---

ä¸è¿‡Reactåœ¨ç”Ÿäº§ä¸­å¹¶ä¸æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼å»æ£€æŸ¥çš„. ğŸ˜³

ä½¿ç”¨ `instanceof` çš„åˆ¤æ–­æ–¹å¼æœ‰ä¸ªå¼Šç«¯, å½“æˆ‘ä»¬çš„é¡µé¢ä¸­å­˜åœ¨å¤šä¸ª React çš„æ‹·è´æ—¶,  æˆ‘ä»¬æ£€æŸ¥çš„æŸä¸ªç»„ä»¶å¯èƒ½ç»§æ‰¿è‡ªå¦ä¸€ä¸ª React æ‹·è´çš„ `React.Component` . åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨å¤šä¸ª React æ‹·è´å½“ç„¶æ˜¯ä¸æ¨èçš„åšæ³•. ä½†æ˜¯ç”±äºå†å²åŸå› , æˆ‘ä»¬å¯èƒ½ä¼šç”¨å¤šä¸ª React æ‹·è´æ¥è§£å†³æŸäº›é—®é¢˜. (ä¸è¿‡å¦‚æœæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Hooks çš„è¯, [æˆ‘ä»¬å¯èƒ½å¿…é¡»è¦ç¦æ­¢å¤šä¸ªæ‹·è´çš„å­˜åœ¨](https://github.com/facebook/react/issues/13991).)

å¦ä¸€ä¸ªåˆ¤æ–­æ–¹å¼æ˜¯, æ£€æŸ¥åŸå‹é“¾ä¸­çš„ `render` æ–¹æ³•æ˜¯å¦å­˜åœ¨. ç„¶è€Œ, å½“æ—¶å¯¹äº[ç»„ä»¶ç›¸å…³çš„ API è§„èŒƒå¹¶æ²¡æœ‰å®Œå…¨ç¡®å®šä¸‹æ¥.](https://github.com/facebook/react/issues/4599#issuecomment-129714112) éšæ—¶å¯èƒ½ä¼šå˜åŒ–. å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼çš„è¯, Every check has a cost so we wouldnâ€™t want to add more than one. åŒæ—¶, å¦‚æœ `render` è¢«å®šä¹‰ä¸ºå®ä¾‹æ–¹æ³•çš„è¯, è¿™ç§æ–¹å¼ä¹Ÿä¼šå¤±æ•ˆ.

å› æ­¤ React é‡‡ç”¨äº†ä¸€ç§ç»™åŸºç¡€ç»„ä»¶[æ·»åŠ ](https://github.com/facebook/react/pull/4663)ç‰¹æ®Šæ ‡å¿—çš„æ–¹å¼. React ä¼šæ£€æŸ¥è¿™ä¸ªæ ‡å¿—æ˜¯å¦å­˜åœ¨, é€šè¿‡è¿™ä¸ªæ ‡å¿—æ¥åˆ¤æ–­è¿™æ˜¯ä¸ªç±»ç»„ä»¶è¿˜æ˜¯å‡½æ•°ç»„ä»¶.

åœ¨æœ€åˆçš„å®ç°ç‰ˆæœ¬ä¸­, è¿™ä¸ªæ ‡å¿—å­˜åœ¨äº `React.Compoenent` æœ¬èº«:

```jsx
// Inside React
class Component {}
Component.isReactClass = {};

// We can check it like this
class Greeting extends Component {}
console.log(Greeting.isReactClass); // âœ… Yes
```

ç„¶è€Œ, ä¸€äº›ç±»åœ¨[å®ç°](https://github.com/scala-js/scala-js/issues/1900)ä¸Šå¹¶æ²¡æœ‰æ‹·è´é™æ€å±æ€§æˆ–è€…è®¾ç½®éæ ‡å‡†çš„ `__proto__` . åœ¨è¿™ç§æƒ…å†µä¸‹ React æ·»åŠ çš„ç‰¹æ®Šæ ‡å¿—å°±ä¸¢å¤±äº†.

äºæ˜¯Reactå›¢é˜Ÿ[å°†è¿™ä¸ªæ ‡å¿—è½¬ç§»](https://github.com/facebook/react/pull/5021)åˆ°äº† `React.Component.prototype` ä¸Šäº†:

```jsx
// Inside React
class Component {}
Component.prototype.isReactComponent = {};

// We can check it like this
class Greeting extends Component {}
console.log(Greeting.prototype.isReactComponent); // âœ… Yes
```

ä¹Ÿè®¸å¾ˆå¤šäººä¼šç–‘æƒ‘, ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ ‡è¯†ä¸æ˜¯å¸ƒå°”å€¼è€Œæ˜¯å¯¹è±¡. è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä½¿ç”¨ Jest è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶, å‰å‡ ä¸ªç‰ˆæœ¬çš„ Jest é»˜è®¤æ‰“å¼€äº†[automocking](https://dev.to/slashgear_/discover-jest-hidden-feature-automock-2c9f), ç”Ÿæˆçš„æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®ä¼š[å¿½ç•¥åŸå§‹å€¼](https://github.com/facebook/react/pull/4663#issuecomment-136533373), å› æ­¤å¦‚æœç”¨å¸ƒå°”å€¼çš„è¯, ä¼šå½±å“è‡ªåŠ¨åŒ–æµ‹è¯•çš„ç»“æœ.

`isReactComponent` çš„æ£€æµ‹æ–¹å¼è‡³ä»Šä¾ç„¶åœ¨[ä½¿ç”¨](https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/react-reconciler/src/ReactFiber.js#L297-L300). 

å¦‚æœä½ åœ¨ç¼–å†™Reactç»„ä»¶çš„æ—¶å€™æ²¡æœ‰ç»§æ‰¿ `React.Component` . Reactå°±ä¸ä¼šåœ¨åŸå‹é“¾ä¸­æ‰¾åˆ° `isReactComponent` è¿™ä¸ªå±æ€§, ä¹Ÿä¸ä¼šå°†å…¶çœ‹åš class ç»„ä»¶. è¯»åˆ°è¿™é‡Œ, å¤§å®¶å¯èƒ½å°±éƒ½æ˜ç™½[è¿™ä¸ªé—®é¢˜](https://stackoverflow.com/questions/38481857/getting-cannot-call-a-class-as-a-function-in-my-react-project/42680526#42680526)çš„ç­”æ¡ˆäº†: å¦‚æœåœ¨Reactçš„å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ° `Cannot call a class as a function` çš„æŠ¥é”™, è®°å¾—åœ¨ä½¿ç”¨React ç±»ç»„ä»¶æ—¶åŠ ä¸Š `extends React.Component` . åŒæ—¶å¦‚æœä½ æ²¡æœ‰è¿™æ ·ä½¿ç”¨ç±»ç»„ä»¶, å´ç»„ä»¶å†…å´å®šä¹‰äº† `render` æ–¹æ³•, Reactä¹Ÿä¼šæŠ¥å‡ºä¸€ä¸ª[âš ï¸](https://github.com/facebook/react/pull/11168). 

---

ä½ å¯èƒ½ä¼šè§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç‚¹æŒ‚ç¾Šå¤´å–ç‹—è‚‰ ([bait-and-switch](https://en.wikipedia.org/wiki/Bait-and-switch)) çš„æ„Ÿè§‰. **å®é™…çš„è§£å†³æ–¹æ¡ˆé‚£ä¹ˆç®€å•, å¯æ˜¯æˆ‘ä»¬å´ä¸ç›´æ¥å›ç­”è¿™ä¸ªé—®é¢˜, è€Œæ˜¯é¥¶äº†é‚£ä¹ˆä¸€å¤§åœˆå»è§£é‡Šä¸ºä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆæ˜¯ä¸å¯è¡Œçš„.** 

åœ¨æˆ‘çš„ç»éªŒä¸­, åœ¨å®ç°ä¸€ä¸ªåº“çš„ API æ—¶, è¿™æ˜¯ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µ. å¯¹äºä¸€ä¸ªä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿çš„ API, ä½ å¿…é¡»è¦æ·±å…¥è€ƒè™‘è¯­è¨€æœ¬èº«çš„è¯­ä¹‰, è¿è¡Œæ—¶çš„æ€§èƒ½, å­˜åœ¨/ä¸å­˜åœ¨ç¼–è¯‘æ­¥éª¤æ—¶çš„æ•ˆç‡, ç›¸å…³ç”Ÿæ€çš„å‘å±•ä»¥åŠæ‰“åŒ…æ–¹æ¡ˆ, æ—©æœŸçš„å‘Šè­¦ä»¥åŠå¾ˆå¤šå…¶ä»–é—®é¢˜. æœ€ç»ˆè®¾è®¡å‡ºæˆæœæˆ–è®¸ä¸ä¼šæ˜¯æœ€ä¼˜é›…çš„, ä½†æ˜¯è‚¯å®šæ˜¯æœ€å®ç”¨çš„.

å¦‚æœæœ€ç»ˆè®¾è®¡å‡ºæ¥çš„ API å¾ˆæˆåŠŸçš„è¯, é‚£ä¹ˆ API çš„ä½¿ç”¨è€…å°±å®Œå…¨ä¸éœ€è¦è€ƒè™‘å®ƒçš„è®¾è®¡è¿‡ç¨‹, åªéœ€è¦ä¸“æ³¨äºåˆ›å»ºåº”ç”¨å³å¯.

å¦‚æœä½¿ç”¨è€…å¯¹ API çš„è®¾è®¡æ„Ÿåˆ°å¥½å¥‡, äº†è§£å®ƒçš„åº•å±‚åŸç†å½“ç„¶æ˜¯å¾ˆå¥½çš„.