<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="IDYUPnBNhdnU8o9LRNKZ1RSt14tIxTI0rLeMrBtswXw"><title> Iterators ä¸ for-of å¾ªç¯ Â· Fish</title><meta name="description" content="Iterators ä¸ for-of å¾ªç¯ - Fish"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/posts/favicon.png"><link rel="stylesheet" href="/posts/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://icyfish.github.io/posts/atom.xml" title="Fish"><meta name="generator" content="Hexo 7.0.0-rc1"></head><body><div class="wrap"><header><a href="/posts/" class="logo-link"><img src="/posts/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/posts/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/posts/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/posts/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="http://twitter.com/icyfish_" target="_blank" class="nav-list-link">TWITTER</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Iterators ä¸ for-of å¾ªç¯</h1><div class="post-info">Jan 2, 2018</div><div class="post-content"><p>Iterators ä¸ for-of å¾ªç¯</p>
<a id="more"></a>
<h2 id="å¾ªç¯éå†æ•°ç»„çš„å‡ ç§æ–¹å¼"><a href="#å¾ªç¯éå†æ•°ç»„çš„å‡ ç§æ–¹å¼" class="headerlink" title="å¾ªç¯éå†æ•°ç»„çš„å‡ ç§æ–¹å¼"></a>å¾ªç¯éå†æ•°ç»„çš„å‡ ç§æ–¹å¼</h2><h3 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myArray = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; myArray.length; index++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(myArray[index]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ES5-forEach"><a href="#ES5-forEach" class="headerlink" title="ES5 forEach"></a>ES5 forEach</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myArray = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">myArray.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>forEachçš„å†…éƒ¨å‡½æ•°<strong>æ— æ³•ä½¿ç”¨ <code>break</code> æˆ– <code>return</code></strong>(?)</p>
<h2 id="for-in"><a href="#for-in" class="headerlink" title="for-in"></a>for-in</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myArray = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> myArray) &#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(myArray[index]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨<code>forâ€“in</code>å¾ªç¯éå†æ•°ç»„ä¸å¯å–: </p>
<ul>
<li><p>indexæ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å­—: <code>&quot;0&quot;</code>, <code>&quot;1&quot;</code>, <code>&quot;2&quot;</code>ç­‰</p>
</li>
<li><p>æœ‰æ—¶å€™ä¸ä»¥æ­£å¸¸çš„é¡ºåºå¾ªç¯éå†</p>
</li>
<li><p>æ— æ³•æ­£å¸¸éå†æŸäº›æ•°ç»„, å¦‚: </p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [] </span><br><span class="line">a[<span class="number">5</span>] = <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ­£å¸¸forå¾ªç¯ç»“æœ:</span></span><br><span class="line"><span class="comment">   undefined</span></span><br><span class="line"><span class="comment">   undefined</span></span><br><span class="line"><span class="comment">   undefined</span></span><br><span class="line"><span class="comment">   undefined</span></span><br><span class="line"><span class="comment">   undefined</span></span><br><span class="line"><span class="comment">   3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = []</span><br><span class="line">a[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">in</span> a) &#123;</span><br><span class="line">    <span class="comment">// å¿½ç•¥äº†æ•°ç»„å…ƒç´ ä¸­çš„å‰5ä¸ªå…ƒç´ , åªæœ‰3è¢«è¾“å‡º</span></span><br><span class="line">    <span class="built_in">console</span>.log(a[x])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* for-inç»“æœ:</span></span><br><span class="line"><span class="comment">   3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°ç»„ä¸­è‹¥æœ‰<strong>å¯æšä¸¾å±æ€§(enumerable property)?</strong>,ä¹Ÿä¼šè¢«éå†</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.foo = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">in</span> a)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* è¾“å‡º:</span></span><br><span class="line"><span class="comment">   0</span></span><br><span class="line"><span class="comment">   1</span></span><br><span class="line"><span class="comment">   2</span></span><br><span class="line"><span class="comment">   3</span></span><br><span class="line"><span class="comment">   4</span></span><br><span class="line"><span class="comment">   foo</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="for-of"><a href="#for-of" class="headerlink" title="for-of"></a>for-of</h3><ul>
<li>éå†æ•°ç»„æœ€ç®€å•ç›´æ¥çš„æ–¹å¼</li>
<li>æ²¡æœ‰ <code>for-in</code>, <code>forEach</code>å­˜åœ¨çš„é‚£äº›ç¼ºé™·</li>
<li><p>ä¸<code>for-in</code>çš„åŒºåˆ«:<br><code>for-in</code>å¾ªç¯éå†å¯¹è±¡å±æ€§<br><code>forâ€“of</code>å¾ªç¯éå†æ•°æ®(å¦‚æ•°ç»„ä¸­çš„å„ä¸ªå…ƒç´ )</p>
</li>
<li><p><code>for-of</code>è¿˜å¯ä»¥å¾ªç¯éå†å…¶å®ƒç±»å‹çš„é›†åˆ, å¦‚ç±»æ•°ç»„å¯¹è±¡: NodeLists, å­—ç¬¦ä¸²ç­‰:</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> chr <span class="keyword">of</span> <span class="string">"ğŸ˜ºğŸ˜²"</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(chr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¹Ÿå¯ä»¥ç”¨äºéå†<code>Set</code>å’Œ<code>Map</code>å¯¹è±¡:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> words = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="keyword">var</span> uniqueWords = <span class="keyword">new</span> <span class="built_in">Set</span>(words)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> word <span class="keyword">in</span> uniqueWords)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(word)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  å¯¹äº<code>Map</code>å¯¹è±¡, éœ€è¦å…ˆè§£æ„å†éå†: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> [key, value] <span class="keyword">of</span> phoneBookMap) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">"'s phone number is: "</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸è¿‡<code>for-of</code>ä¸å¯ç›´æ¥ç”¨äºéå†ä¸€èˆ¬çš„å¯¹è±¡(plain object), å¦‚æœæƒ³è¦éå†è¿™ç§å¯¹è±¡çš„å±æ€§, åº”è¯¥å€ŸåŠ©<code>for-in</code>æˆ–è€…<code>Object.keys()</code>:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someObject = &#123; <span class="number">0</span>: <span class="string">'a'</span>, <span class="number">1</span>: <span class="string">'b'</span>, <span class="number">2</span>: <span class="string">'c'</span>, <span class="string">'hello'</span>: <span class="string">'world'</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(someObject)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">": "</span> + someObject[key]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="for-ofçš„åŸç†"><a href="#for-ofçš„åŸç†" class="headerlink" title="for-ofçš„åŸç†"></a><code>for-of</code>çš„åŸç†</h4><p><code>for-of</code>é€šè¿‡è°ƒç”¨å¯¹è±¡æ–¹æ³•èµ·ä½œç”¨, <code>Array</code>, <code>Map</code>, <code>Set</code>ç­‰å¯éå†çš„å¯¹è±¡éƒ½æœ‰ä¸ªå…±åŒç‰¹ç‚¹, å®ƒä»¬æœ‰<strong>éå†å™¨(iterator)</strong>æ–¹æ³•. </p>
<p><code>for-of</code>æ— æ³•éå†ä¸€èˆ¬çš„å¯¹è±¡æ˜¯å› ä¸ºä¸€èˆ¬å¯¹è±¡çš„å±æ€§ä¸­æ²¡æœ‰éå†å™¨æ–¹æ³•, ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨åœ¨å¯¹è±¡åŸå‹ä¸­æ·»åŠ è¯¥æ–¹æ³•<code>myObject[Symbol.iterator]()</code>, å°±èƒ½å¤Ÿä½¿è¯¥å¯¹è±¡å¯ä»¥è¢«<code>for-of</code>å¾ªç¯éå†:</p>
<p>ä½¿ç”¨<code>forâ€“of</code>å¾ªç¯éå†å¯¹è±¡, é¦–å…ˆè°ƒç”¨äº†<code>[Symbol.iterator]()</code>æ–¹æ³•, è°ƒç”¨åçš„ç»“æœæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å¯éå†çš„å¯¹è±¡, è¿™ä¸ªå¯¹è±¡çš„å±æ€§ä¸­æœ‰ä¸ª<code>next()</code>æ–¹æ³•, <code>for-of</code>åœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡è¯¥æ–¹æ³•. ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¯éå†å¯¹è±¡çš„ä¾‹å­:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> zeroesForeverIterator = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  next: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">done</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="number">0</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºä»¥ä¸Šçš„å¯¹è±¡, æ¯æ¬¡<code>next()</code>è¢«è°ƒç”¨, éƒ½ä¼šè¿”å›åŒæ ·çš„ç»“æœ, å‘Šè¯‰<code>for-of</code>å¾ªç¯: 1).éå†è¿˜æœªç»“æŸ; 2). ä¸‹ä¸€ä¸ªå€¼æ˜¯0.<br>æ­¤æ—¶,<code>for (value of zeroesForeverIterator) {}</code>å°±æ˜¯ä¸ªæ— é™å¾ªç¯.</p>
<p>å«æœ‰éå†å™¨æ–¹æ³•çš„å¯¹è±¡è¿˜å®ç°äº†å¯é€‰çš„<code>.return()</code>æ–¹æ³•å’Œ<code>.throw(exc)</code>æ–¹æ³•. å¦‚æœå¾ªç¯ç”±äºæŠ›å‡ºå¼‚å¸¸æˆ–<code>break</code>æˆ–<code>return</code>å£°æ˜è¿‡æ—©é€€å‡º, <code>for-of</code>ä¼šè°ƒç”¨<code>.return()</code>. ä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹, ä¸éœ€è¦ç”¨åˆ°<code>.return()</code>æ–¹æ³•, <code>.throw(exc)</code>æ›´ç‰¹æ®Š, <code>for-of</code>ä»ä¸è°ƒç”¨è¯¥æ–¹æ³•. (more about it?)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (VAR <span class="keyword">of</span> ITERABLE) &#123;</span><br><span class="line">  STATEMENTS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Š<code>for-of</code>å¾ªç¯, å®é™…ä¸Šæ‰§è¡Œçš„æ“ä½œæ˜¯(ç®€å•ç‰ˆæœ¬): </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $iterator = ITERABLE[<span class="built_in">Symbol</span>.iterator]();</span><br><span class="line"><span class="keyword">var</span> $result = $iterator.next();</span><br><span class="line"><span class="keyword">while</span> (!$result.done) &#123;</span><br><span class="line">  VAR = $result.value;</span><br><span class="line">  STATEMENTS</span><br><span class="line">  $result = $iterator.next();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šåªæ˜¯ç®€å•çš„ç‰ˆæœ¬, å¤§è‡´ä½“ç°äº†<code>for-of</code>æ˜¯å¦‚ä½•å®ç°çš„, å®é™…ä¸Šæ›´å¤æ‚, ä½†å¯¹äºç†è§£ä¸Šå¹¶æ²¡æœ‰å¤ªå¤§çš„å¸®åŠ©, å› æ­¤çœç•¥æŸäº›æ–¹æ³•çš„å®ç°(ä¾‹å¦‚æ˜¯å¦‚ä½•å¤„ç†<code>return()</code>çš„). <code>for-of</code>å¾ˆå¥½ç”¨, ä½†æ˜¯åº•å±‚çš„å®ç°æ¯”è¾ƒå¤æ‚.</p>
<h4 id="ä½¿ç”¨for-of"><a href="#ä½¿ç”¨for-of" class="headerlink" title="ä½¿ç”¨for-of"></a>ä½¿ç”¨<code>for-of</code></h4><p>æˆªè‡³åŸæ–‡å®Œæˆçš„æ—¶é—´<strong>(2015-04-29)</strong>, æŸäº›æµè§ˆå™¨è¿˜ä¸æ”¯æŒ<code>for-of</code>, åœ¨Chromeä¸­, å¯æ‰“å¼€<code>chrome://flags</code>æ‰¾åˆ°â€œExperimental JavaScriptâ€å¹¶è¿›è¡Œå¯ç”¨. åœ¨æœåŠ¡ç«¯æƒ³è¦ä½¿ç”¨è¯¥ç‰¹æ€§, åœ¨æ‰§è¡ŒNodeæŒ‡ä»¤æ—¶åŠ ä¸Š<code>--harmony</code>é€‰é¡¹. </p>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><ul>
<li><a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/" target="_blank" rel="noopener">Iterators and the for-of loop</a></li>
</ul>
<p>Next articles will be: </p>
<ul>
<li><p><a href="https://hacks.mozilla.org/2015/05/es6-in-depth-generators/" target="_blank" rel="noopener">Generators</a> in <a href="https://hacks.mozilla.org/author/jorendorffmozillacom/page/2/" target="_blank" rel="noopener">ES6 In Depth</a>.</p>
</li>
<li><p>CSS Modules </p>
</li>
</ul>
<p>Questions In This Article: <code>cmd + f</code> + <code>?</code></p>
</div></article></div></main><footer><div class="paginator"><a href="/posts/2018/01/18/react-ref/" class="prev">PREV</a><a href="/posts/2017/12/25/script-error/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2019 - 2023 <a href="https://icyfish.github.io/posts">Fish</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>